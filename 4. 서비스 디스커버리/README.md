# 서비스 디스커버리
> 분산 아키텍처에서는 호스트 이름과 머신이 위치한 IP 주소를 알아야 한다. 이 개념은 분산 컴퓨팅 초창기 때부터 존재했고 공식적으로 ‘서비스 디스커버리(service discovery)’로 알려져 있다. 서비스 디스커버리는 애플리케이션이 사용하는 모든 원격 서비스의 주소가 포함된 프로퍼티 파일을 관리하는 것처럼 단순하거나 UDDI(Universal Description, Discovery, and Integration) 저장소처럼 정형화된 것일 수 있다. 서비스 디스커버리는 다음 두 가지 핵심적인 이유로 마이크로서비스와 클라우드 기반 애플리케이션에 매우 중요하다.

- **수평 확장(horizontal scaling or scale out)**: 대개 이 패턴은 애플리케이션 아키텍처에서 클라우드 서비스 내 더 많은 서비스 인스턴스 및 컨테이너를 추가하는 것과 같은 조정을 요구한다.
- **회복성(resiliency)**: 이 패턴은 비즈니스에 영향을 주지 않고 아키텍처와 서비스 내부의 문제로 충격을 흡수하는 능력을 의미한다. 마이크로서비스 아키텍처에서는 한 서비스의 문제가 전체로 확산되어 서비스 소비자에게 전파되는 것을 막는데, 매우 신중해야 한다.

## 장점

- 첫째, **서비스 디스커버리를 사용하면 애플리케이션 팀은 해당 환경에서 실행 중인 서비스 인스턴스의 수를 빠르게 수평 확장할 수 있다는 장점**이 있다. 서비스 소비자에게 서비스의 물리적 위치는 추상화되어 있다. 즉, 서비스 소비자는 실제 서비스 인스턴스의 물리적 위치를 알지 못하기 때문에 새 서비스 인스턴스는 가용 서비스 풀(pool)에 추가되거나 제거될 수 있다.<br><br>서비스 소비자를 중단하지 않고 서비스를 확장하고 축소할 수 있는 이러한 능력은 매력적인 개념이다. 모놀리식과 싱글 테넌트(single-tenant)(예를 들어 한 고객을 위한) 애플리케이션을 구축하는 데 익숙한 개발 팀이 더 크고 좋은 하드웨어를 추가하는 수직 확장만이 유일한 확장 방식이라는 고정 관념에서 벗어나게 하고, 더 많은 서버를 추가하는 수평 확장을 더욱 강력한 접근 방식으로 인식하게 할 수 있다.<br><br>일반적으로 모놀리식 방식을 사용하면 개발 팀은 필요한 용량보다 초과 구매를 하게 된다. 이때 용량 증가는 큰 단위로 급증하지만 부드럽고 안정적으로 진행되는 경우는 드물다. 예를 들어 휴일 전 전자 상거래 사이트에서 증가하는 요청 수를 생각해 보자. 마이크로서비스를 사용하면 필요에 따라 새로운 서비스 인스턴스를 확장할 수 있다. 서비스 디스커버리(service discovery)를 사용하면 이러한 배포를 추상화하는 데 도움이 되며 서비스 소비자가 배포에 영향을 받지 않게 해 준다.
- 둘째, 서비스 디스커버리의 또 다른 장점은 **애플리케이션 회복성을 향상**시킨다는 것이다. 마이크로서비스 인스턴스가 비정상이거나 가용하지 못한 상태가 되면 대부분의 서비스 디스커버리 엔진은 그 인스턴스를 가용 서비스 목록에서 제거한다. 서비스 디스커버리 엔진은 사용이 불가한 서비스를 우회해서 라우팅하기 때문에 다운된 서비스로 입은 피해를 최소화한다.

## 서비스 위치 확인

- 애플리케이션이 여러 서버에 분산된 자원을 호출할 경우 이 자원들의 물리적 위치를 알고 있어야 한다. 클라우드가 아닌 환경에서 서비스 위치 확인(location resolution)은 대개 DNS와 네트워크 로드 밸런서의 조합으로 해결되었다. 이러한 전통적인 시나리오에서 애플리케이션은 조직의 다른 부분에 위치한 서비스를 호출해야 할 때 서비스의 고유 경로와 일반적인 DNS 이름을 사용하여 호출을 시도했다. DNS 이름은 F5 로드 밸런서(http://f5.com) 등 상용 로드 밸런서나 HAProxy(http://haproxy.org) 등 오픈 소스 로드 밸런서 위치로 정의된다.

> DNS와 로드 밸런서를 사용하는 전통적인 서비스 위치 확인 모델


## 클라우드에서 서비스 디스커버리

## 스프링 유레카 서비스 구축

## 스프링 유레카에 서비스 등록

## 서비스 디스커버리를 이용한 서비스 검색